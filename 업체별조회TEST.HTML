<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>구매 이력 조회 · 업체 드롭다운 + 전체 검색</title>
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<style>
  :root { --bg:#0f172a; --panel:#111827; --ink:#e5e7eb; --muted:#9ca3af; --brand:#60a5fa; --border:#1f2937; }
  *{box-sizing:border-box;}
  body{background:var(--bg);color:var(--ink);
    font-family:system-ui,-apple-system,Segoe UI,Roboto,"Apple SD Gothic Neo","Noto Sans KR",sans-serif; margin:0;}
  header{padding:18px 20px;border-bottom:1px solid var(--border);
    position:sticky;top:0;background:linear-gradient(180deg,rgba(15,23,42,.98),rgba(15,23,42,.92));
    backdrop-filter:blur(6px);z-index:10;}
  h1{margin:0 0 10px;font-size:20px;font-weight:700;}
  .controls{display:grid;gap:10px;grid-template-columns:1fr 1.2fr 1fr;}
  .controls label{font-size:12px;color:var(--muted);}
  .control{display:grid;gap:6px;}
  select,input[type="search"],input[list],button,input[type="file"]{
    background:#0b1220;border:1px solid var(--border);color:var(--ink);
    padding:10px 12px;border-radius:12px;outline:none;font-size:14px;}
  select{cursor:pointer;}
  select option{background:#0b1220;color:var(--ink);}
  button.primary{background:var(--brand);border-color:transparent;color:#0b1220;font-weight:700;}
  button.ghost{background:transparent;border:1px solid var(--border);}
  main{padding:16px 20px 80px;}
  table{width:100%;border-collapse:collapse;background:#0b1220;border:1px solid var(--border);
    border-radius:12px;overflow:hidden;}
  th{position:sticky;top:0;background:#0d1526;color:var(--muted);font-weight:600;font-size:12px;
    border-bottom:1px solid var(--border);padding:10px 8px;text-align:left;cursor:pointer;user-select:none;}
  th:hover{background:#111b33;color:var(--brand);}
  th.sortable::after{content:" ⬍";opacity:0.3;margin-left:4px;}
  th.sort-asc::after{content:" ⬆";opacity:1;}
  th.sort-desc::after{content:" ⬇";opacity:1;}
  tbody td{padding:10px 8px;border-bottom:1px solid var(--border);font-size:14px;}
  tbody tr:hover{background:rgba(96,165,250,0.08);}
  .right{text-align:right;}
  .hidden{display:none;}
  .footer{position:fixed;bottom:12px;right:12px;display:flex;gap:8px;}
  .summary{margin-top:10px;color:var(--muted);font-size:12px;}
</style>
</head>
<body>
<header id="pageHeader">
  <h1>구매 이력 조회 · 업체 드롭다운 + 전체 검색</h1>
  <div class="controls">
    <div class="control">
      <label>데이터 파일 (Excel .xlsx) — 기본: data.xlsx (GitHub)</label>
      <input id="file" type="file" accept=".xlsx,.xls" />
    </div>
    <div class="control">
      <label>구매처명 (드롭
